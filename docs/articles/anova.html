<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphical Analysis of Variance • VisualStats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Graphical Analysis of Variance">
<meta property="og:description" content="VisualStats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VisualStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/anova.html">Graphical Analysis of Variance</a>
    </li>
    <li>
      <a href="../articles/loess.html">Loess Regression</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jbryer/VisualStats/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="anova_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Graphical Analysis of Variance</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbryer/VisualStats/blob/master/vignettes/anova.Rmd"><code>vignettes/anova.Rmd</code></a></small>
      <div class="hidden name"><code>anova.Rmd</code></div>

    </div>

    
    
<p><strong>Author: Jason Bryer, Ph.D. and Bruce Dudek, Ph.D.</strong><br><strong>Last updated: 2022-02-05</strong></p>
<p>Analysis of variance (ANOVA) remains an important statistical method for a variety of situations. ANOVA is typically taught along with other null hypothesis tests (e.g. t-test, chi-squared), however, there are many nuances differences in how the test statistic is calculated that many students do not fully understand. Specifically, why use the ratio of mean square between (or treatment) and mean square within (or error) as the test statistic? Pruzek and Helmreich (2010) introduced a visualization that attempts visualize all the components of ANOVA. This visualization was implemented in the <code>granova</code> (2014) R package utilizing the base graphics system. This document introduces a version of the granova visualization usinge <code>ggplot2</code> Wickham (2016) that provides a number parameters to isoloate certain features of their visualization. We use this approach in teaching ANOVA, mostly through the use of Shiny (Chang et al, 2021) that allows the user/students to interactively add and remove plot features.</p>
<p>To exemplify this appraoch we will explore the effects of different approaches of hand-washing has on bacteria counts (De Veaux et al, 2009). Specifically, each of four types of hand-washing (alcohol spray, antibacterial soap, regular soap, and water only) were replicated eight times resulting in 32 observations. The boxplot below provides a summary of the data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">hand_washing</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Method</span>, y <span class="op">=</span> <span class="va">Bacterial_Counts</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-1-1.png" alt="Boxplot of Bacterial Counts by Hand Washing Method" width="700"><p class="caption">
Boxplot of Bacterial Counts by Hand Washing Method
</p>
</div>
<p>When conceptualizing variances graphically, we wish to draw squares. Consider the formula for the sample variance:</p>
<p><span class="math display">\[s^2 = \frac{\sum(x_i - \bar{x})^2}{n - 1}\]</span></p>
<p>If we focus on the numerator for a singe observation, say <span class="math inline">\(i = 1\)</span>, <span class="math inline">\((x_1 - \bar{x})^2\)</span>, the contribution to the variance calculation for the first observation can be conceptualized as a square with edges of length <span class="math inline">\(x_i - \bar{x}\)</span>. Therefore, the sample variance (which we can also call mean square total - which ignores group membership) is approximately the average of the area of all those squares (see the figure below). <em>NOTE: It is approximate because the sample variance has <span class="math inline">\(n-1\)</span> in the denominator. The true average, using the population variances, would have <span class="math inline">\(n\)</span> in the denominator.</em> This visualization of squares sets up delineation of the visualization of components of ANOVA.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/variance_vis.html">variance_vis</a></span><span class="op">(</span><span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-2-1.png" alt="Visualization of Total Variance" width="700"><p class="caption">
Visualization of Total Variance
</p>
</div>
<p>In order to use squares to represent the partitioned variance components in ANOVA, it is convenient to derive the deviation of each group mean from the grand mean. This aligns with using “effect coding” to code for group membership in linear modeling. Some times this kind of coding is labeled “deviation coding”. These deviations form a type of contrast and we can visualize one for each group. Consider the summary statistics for each group.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">desc</span> <span class="op">&lt;-</span> <span class="fu">describeBy</span><span class="op">(</span><span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
                   <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>, 
                   mat <span class="op">=</span> <span class="cn">TRUE</span>, skew <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">desc</span></code></pre></div>
<pre><code>##     item             group1 vars n  mean       sd min max range        se
## X11    1      Alcohol Spray    1 8  37.5 26.55991   5  82    77  9.390345
## X12    2 Antibacterial Soap    1 8  92.5 41.96257  20 164   144 14.836008
## X13    3               Soap    1 8 106.0 46.95895  51 207   156 16.602496
## X14    4              Water    1 8 117.0 31.13106  74 170    96 11.006492</code></pre>
<p>The mean of the dependent variable is 88.25. If we subtract this value from each group mean, then the deviance in the <em>x</em>-axis will be proportional to each groups deviance from the grand mean.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">desc</span><span class="op">$</span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="va">desc</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span><span class="op">)</span></code></pre></div>
<p>The following figure plots the dependent variable (bacterial counts) in the <em>y</em>-axis and each group is located at a position on the <em>x</em>-axis defined by the deviation for that group mean (the deviations must sum to zero).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-5-1.png" alt="Boxplot Using Deviation Contrasts on x-axis" width="700"><p class="caption">
Boxplot Using Deviation Contrasts on x-axis
</p>
</div>
<p>An important advantage of using deviation contrasts is that a one unit change in the <em>x</em>-axis is the same as a one unit change in the <em>y</em>-axis. We can verify this by adding the unit line (i.e. <span class="math inline">\(y = x\)</span>) to the plot and see that the line intersects mean of each group. We also added the grand, overall, mean in both the <em>x</em> and <em>y</em>-axes. The dashed lines represent the grand mean in two ways: 1. raw scale grand mean in the <em>y</em>-axis and 2. the deviation scale in the <em>x</em>-axis.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-6-1.png" alt="Scatter Plot of Bacterial Counts against Deviation Contrast" width="700"><p class="caption">
Scatter Plot of Bacterial Counts against Deviation Contrast
</p>
</div>
<p>The following table has the formulas for each component of an ANOVA summary table.</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="30%">
<col width="3%">
<col width="19%">
<col width="18%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Source</th>
<th align="center">Sum of Squares</th>
<th align="center"><em>df</em></th>
<th align="center">MS</th>
<th align="center">F</th>
<th>p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Between Group (Treatment)</td>
<td align="center"><span class="math inline">\(\sum^{}_{k} n_{k}(\bar{x}_{k} -\bar{x} )^{2}\)</span></td>
<td align="center"><span class="math inline">\(k - 1\)</span></td>
<td align="center"><span class="math inline">\(\frac{SS_{between}}{df_{between}}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MS_{between}}{MS_{within}}\)</span></td>
<td>area to right of <span class="math inline">\(F_{k-1,n-k}\)</span>
</td>
</tr>
<tr class="even">
<td>Within Group (Error)</td>
<td align="center"><span class="math inline">\(\sum^{}_{k} \sum^{}_{i} (\bar{x}_{ik} -\bar{x}_{k} )^{2}\)</span></td>
<td align="center"><span class="math inline">\(n - k\)</span></td>
<td align="center"><span class="math inline">\(\frac{SS_{within}}{df_{within}}\)</span></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="center"><span class="math inline">\(\sum^{}_{k} \sum^{}_{i} (\bar{x}_{ik} -\bar{x} )^{2}\)</span></td>
<td align="center"><span class="math inline">\(n - 1\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
</tbody>
</table>
<p>With <em>k</em> being each group and <em>i</em> the observation within group <em>k</em>, the calculation for the within group component involves calculating the deviance from the group mean. In the figure below, the vertical line for each group represents one standard deviation and the area of the box is the variance (<span class="math inline">\(s^2\)</span>; recall that the standard deviation is equal the square root of the variance).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-7-1.png" alt="With Group Variances Represented as Squares" width="700"><p class="caption">
With Group Variances Represented as Squares
</p>
</div>
<p>The mean square within is approximately the average of each groups variances and is represented below as the orange square in the center. Like the variance estimate above, becasue the denominator is <span class="math inline">\(k - 1\)</span> the mean square within will be slightly larger than if we used <span class="math inline">\(k\)</span> in the denominator. By using <span class="math inline">\(k - 1\)</span> we get an <em>unbiased estimate</em>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-8-1.png" alt="Mean Square Within Represented as Orange Square" width="700"><p class="caption">
Mean Square Within Represented as Orange Square
</p>
</div>
<p>Since we have equal group sizes, the pooled standard deviation (here represented by the horizontal dashed blue lines) is approximately to the square root of the mean square between (the difference in these is due to the using the degrees of freedom in the denominator instead of <em>n</em>). This will not necessarily be the case when the group sizes are not equal since we are taking a weighted average (note the *<span class="math inline">\(n_k\)</span> in the formula for the sum of squares between).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-9-1.png" alt="Within Group Mean Square and Pooled Standard Deviation" width="700"><p class="caption">
Within Group Mean Square and Pooled Standard Deviation
</p>
</div>
<p>There are two ways to approach the between group (treatment): 1. Since we know the total sum of squares and the within group sum of squares, we can subtract the within group sum of squares from the total to get the between group sum of squares, or 2. Perform the calculation as presented in the table above. Looking at the fomrula, we see that the between group sum of squares is centered on each group mean’s deviance from the grand mean: <span class="math inline">\((\bar{x}_k - \bar{x})^2\)</span> (note that ${x}_k is the group mean and {x} is the grand mean). The figure below depicts these deviances.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">TRUE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-10-1.png" alt="Between Group Variance Components" width="700"><p class="caption">
Between Group Variance Components
</p>
</div>
<p>Unlike the within group sum of squares, each deviance is multiplied by the group size, <span class="math inline">\(n_k\)</span>. Since we have equal group sizes in this example, they will each contribute equally to the total between group sum of squares, though it should be noted that this is not case with unequal group sizes. As a result, the mean square between is not an average of the deviances, but rather the sum of the deviances multiplied by <span class="math inline">\(\frac{n_k}{k - 1}\)</span> (in this example it is <span class="math inline">\(\frac{8}{3}\)</span>). The resulting mean square between, depicted below as the green square, is going to be larger than all the individual components of the sum of squares.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-11-1.png" alt="Mean Square Between Reprsented as Green Square" width="700"><p class="caption">
Mean Square Between Reprsented as Green Square
</p>
</div>
<p>Now that we have a square representing both the mean square between (in green) and the mean square within (in yellow), the F-statistic is equal to the ratio of the area of these two squares.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/anova_vis.html">anova_vis</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Bacterial_Counts</span>, 
          group <span class="op">=</span> <span class="va">hand_washing</span><span class="op">$</span><span class="va">Method</span>,
          plot_boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_group_sd <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_within <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_ms_between <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_unit_line <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_grand_mean <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_sd_line <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_pooled_sd <span class="op">=</span> <span class="cn">FALSE</span>,
          plot_between_group_variances <span class="op">=</span> <span class="cn">FALSE</span>,
          ylab <span class="op">=</span> <span class="st">'Bacterial Counts'</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-12-1.png" alt="Mean Square Between (green) and Within (orange)" width="700"><p class="caption">
Mean Square Between (green) and Within (orange)
</p>
</div>
<p>The <em>p</em>-value is the area under the F-distribution to the right of the F-statistic (repsrented as a vertical dashed line below).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">df</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>df1 <span class="op">=</span> <span class="fl">3</span>, df2 <span class="op">=</span> <span class="fl">28</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">7.06</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Statistic'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">''</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-13-1.png" alt="F-distribution" width="700"><p class="caption">
F-distribution
</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Chang, W., Cheng, J., Allaire, J.J., Sievert, C, Schloerke, B, Xie, Y, Allen, J., McPherson, J., Dipert, A., &amp; Borges, B. (2021). shiny: Web Application Framework for R. R package version 1.7.1. <a href="https://CRAN.R-project.org/package=shiny" class="uri">https://CRAN.R-project.org/package=shiny</a></p>
<p>De Veaux, R.D., Velleman, P.F., &amp; Bock, D.E. (2009). <em>Intro Stats</em> (4th ed). Pearson.</p>
<p>Pruzek, R.R., &amp; Helmreich, J.E. (2010). Elemental Graphics for Analysis of Variance using the R Package granova. Retrieved from <a href="https://api.semanticscholar.org/CorpusID:54635842" class="uri">https://api.semanticscholar.org/CorpusID:54635842</a></p>
<p>Pruzek, R.M., &amp; Helmreich, J.E. (2014). granova: Graphical Analysis of Variance. R package version 2.1. <a href="https://CRAN.R-project.org/package=granova" class="uri">https://CRAN.R-project.org/package=granova</a></p>
<p>Wickham, H. (2016). <em>ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The <code>anova_vis</code> function specifies <code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">ggplot2::coord_equal</a></code> on all plots.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>See <a href="https://web.ma.utexas.edu/users/mks/M358KInstr/SampleSDPf.pdf" class="uri">https://web.ma.utexas.edu/users/mks/M358KInstr/SampleSDPf.pdf</a> for a detailed explanation.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jason Bryer, Bruce Dudek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
